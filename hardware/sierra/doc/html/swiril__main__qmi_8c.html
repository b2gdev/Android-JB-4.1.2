<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Sierra RIL: hardware/sierra/swiril/swiril_main_qmi.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>hardware/sierra/swiril/swiril_main_qmi.c File Reference</h1>
<p>Provides main QMI-specific Sierra specific functions.  
<a href="#_details">More...</a></p>
<code>#include &lt;telephony/ril.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;assert.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;errno.h&gt;</code><br/>
<code>#include &lt;unistd.h&gt;</code><br/>
<code>#include &lt;sys/types.h&gt;</code><br/>
<code>#include &lt;sys/stat.h&gt;</code><br/>
<code>#include &lt;fcntl.h&gt;</code><br/>
<code>#include &lt;pthread.h&gt;</code><br/>
<code>#include &lt;alloca.h&gt;</code><br/>
<code>#include &lt;getopt.h&gt;</code><br/>
<code>#include &lt;sys/socket.h&gt;</code><br/>
<code>#include &lt;cutils/sockets.h&gt;</code><br/>
<code>#include &lt;termios.h&gt;</code><br/>
<code>#include &lt;cutils/properties.h&gt;</code><br/>
<code>#include &lt;stdbool.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="swiril__log_8h_source.html">swiril_log.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="swiril__main__qmi_8c.html">swiril_oem_qmi.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="swiril__misc__qmi_8h_source.html">swiril_misc_qmi.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="swiril__pdp__qmi_8h_source.html">swiril_pdp_qmi.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="swiril__sim__qmi_8h_source.html">swiril_sim_qmi.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="swiril__network__qmi_8h_source.html">swiril_network_qmi.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="swiril__network_8h_source.html">swiril_network.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="swiril__main__qmi_8h_source.html">swiril_main_qmi.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="swiril__sms__qmi_8h_source.html">swiril_sms_qmi.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="swiril__callhandling_8h_source.html">swiril_callhandling.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="swiril__misc_8h_source.html">swiril_misc.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="qmerrno_8h_source.html">qmerrno.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="SWIWWANCMAPI_8h_source.html">SWIWWANCMAPI.h</a>&quot;</code><br/>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structdevice__info__param.html">device_info_param</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Local definitions for SLQS related data structures.  <a href="structdevice__info__param.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="swiril__main__qmi_8c.html#a7ce0df38eb467e59f209470c8f5ac4e6">LOG_TAG</a>&nbsp;&nbsp;&nbsp;&quot;RIL&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="swiril__main__qmi_8c.html#a0c5a71649c7d04da365b59390efd856b">PROPERTY_PERSIST_SIERRA_NOTIFICATION</a>&nbsp;&nbsp;&nbsp;&quot;persist.sierra.notification&quot;</td></tr>
<tr><td colspan="2"><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structdevice__info__param.html">device_info_param</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="swiril__main__qmi_8c.html#ad5ddd6d6ec8238c5b7a12e566796104c">device_info_t</a></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="swiril__main__qmi_8c.html#a161773a807774685f4abd121f2eeeb7c">getPropertyRadioNotifiction</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="swiril__main__qmi_8c.html#aead5adc65bddee5a1933791ce7fd6878">initRILFunctionHandlerQMI</a> (<a class="el" href="swiril__main_8h.html#a432728982fa236687971409a22307eba">RIL_RequestHandlerFunc</a> *rilsolreqhandlerp, <a class="el" href="swiril__main_8h.html#a432728982fa236687971409a22307eba">RIL_RequestHandlerFunc</a> *rilsolreqhandlercdmap)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="swiril__main__qmi_8c.html#af0f4da0879b635105aebfe8ca49e2b03">qmiSLQSRestart</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="swiril__main__qmi_8c.html#a268d37cf27310c6006d5933de22714db">qmiDeviceConnect</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="swiril__main__qmi_8c.html#a96e4d48594d9663e8bf6bce4961b35fb">qmiDeviceDisconnect</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="swiril__main__qmi_8c.html#a7740355b42e2f55af9a7a4e3c4299615">qmiGetConnectedDeviceID</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="swiril__main__qmi_8c.html#a43786e4f2d3bab2312d4ce47b6842735">clearDeviceNodeAndKey</a> (void)</td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="swiqmi_2qa_2SwiDataTypes_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="swiril__main__qmi_8c.html#a276138a9dc4e151b70badf6b74d47b69">deviceNodeOld</a> [NUM_MAX_STR_LEN]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="swiqmi_2qa_2SwiDataTypes_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="swiril__main__qmi_8c.html#afa5ec65b6b6ea4a6a25e2a44ed13ad29">deviceKeyOld</a> [NUM_MAX_STR_LEN]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="swiril__main__qmi_8c.html#af68ac31b21f881f975bfa48bf4b060cb">sierra_radio_notification</a> = false</td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<dl class="author"><dt><b>Author:</b></dt><dd>Copyright: Â© 2011 Sierra Wireless, Inc. All rights reserved </dd></dl>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a7ce0df38eb467e59f209470c8f5ac4e6"></a><!-- doxytag: member="swiril_main_qmi.c::LOG_TAG" ref="a7ce0df38eb467e59f209470c8f5ac4e6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LOG_TAG&nbsp;&nbsp;&nbsp;&quot;RIL&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a0c5a71649c7d04da365b59390efd856b"></a><!-- doxytag: member="swiril_main_qmi.c::PROPERTY_PERSIST_SIERRA_NOTIFICATION" ref="a0c5a71649c7d04da365b59390efd856b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PROPERTY_PERSIST_SIERRA_NOTIFICATION&nbsp;&nbsp;&nbsp;&quot;persist.sierra.notification&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="ad5ddd6d6ec8238c5b7a12e566796104c"></a><!-- doxytag: member="swiril_main_qmi.c::device_info_t" ref="ad5ddd6d6ec8238c5b7a12e566796104c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structdevice__info__param.html">device_info_param</a>  <a class="el" href="structdevice__info__param.html">device_info_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Local definitions for SLQS related data structures. </p>
<p>Used for: <a class="el" href="qaDcsQCWWAN2kEnumerateDevices_8h.html#aed5012933429c8842342db2340eefbd9">QCWWAN2kEnumerateDevices()</a> <a class="el" href="qaDcsQCWWAN2kConnect_8h.html#aa4136b45f965938712481ba81c36106f">QCWWAN2kConnect()</a> </p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a43786e4f2d3bab2312d4ce47b6842735"></a><!-- doxytag: member="swiril_main_qmi.c::clearDeviceNodeAndKey" ref="a43786e4f2d3bab2312d4ce47b6842735" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clearDeviceNodeAndKey </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a161773a807774685f4abd121f2eeeb7c"></a><!-- doxytag: member="swiril_main_qmi.c::getPropertyRadioNotifiction" ref="a161773a807774685f4abd121f2eeeb7c" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool getPropertyRadioNotifiction </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return the PROPERTY_PERSIST_SIERRA_NOTIFICATION setting. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>true - when the PROPERTY_PERSIST_SIERRA_NOTIFICATION set false - otherwise</dd></dl>
<dl class="user"><dt><b>Abort: </b></dt><dd>none</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>None </dd></dl>

</div>
</div>
<a class="anchor" id="aead5adc65bddee5a1933791ce7fd6878"></a><!-- doxytag: member="swiril_main_qmi.c::initRILFunctionHandlerQMI" ref="aead5adc65bddee5a1933791ce7fd6878" args="(RIL_RequestHandlerFunc *rilsolreqhandlerp, RIL_RequestHandlerFunc *rilsolreqhandlercdmap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initRILFunctionHandlerQMI </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="swiril__main_8h.html#a432728982fa236687971409a22307eba">RIL_RequestHandlerFunc</a> *&nbsp;</td>
          <td class="paramname"> <em>rilsolreqhandlerp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="swiril__main_8h.html#a432728982fa236687971409a22307eba">RIL_RequestHandlerFunc</a> *&nbsp;</td>
          <td class="paramname"> <em>rilsolreqhandlercdmap</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Fill in the QMI RIL command handler function pointer. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>rilsolreqhandlerp</em>&nbsp;</td><td>Pointer to UMTS/GSM handler structure </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>rilsolreqhandlercdmap</em>&nbsp;</td><td>Pointer to CDMA handler structure </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>voicEnable</em>&nbsp;</td><td>voice call enabled or not</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>None</dd></dl>
<dl class="user"><dt><b>Abort: </b></dt><dd>none</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>none </dd></dl>

</div>
</div>
<a class="anchor" id="a268d37cf27310c6006d5933de22714db"></a><!-- doxytag: member="swiril_main_qmi.c::qmiDeviceConnect" ref="a268d37cf27310c6006d5933de22714db" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void qmiDeviceConnect </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a96e4d48594d9663e8bf6bce4961b35fb"></a><!-- doxytag: member="swiril_main_qmi.c::qmiDeviceDisconnect" ref="a96e4d48594d9663e8bf6bce4961b35fb" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void qmiDeviceDisconnect </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a7740355b42e2f55af9a7a4e3c4299615"></a><!-- doxytag: member="swiril_main_qmi.c::qmiGetConnectedDeviceID" ref="a7740355b42e2f55af9a7a4e3c4299615" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int qmiGetConnectedDeviceID </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="af0f4da0879b635105aebfe8ca49e2b03"></a><!-- doxytag: member="swiril_main_qmi.c::qmiSLQSRestart" ref="af0f4da0879b635105aebfe8ca49e2b03" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void qmiSLQSRestart </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>SWI_TBD - After suspend-resume with external GPS enabled the SDK daemon is blocked on a semaphore call and does not get execution time for around 20 seconds. This leads to the API side to timeout leading to the QMI requests and responses to be out of sync. The workaround here kills the SDK process when the API times out and restarts the SDK daemon</p>
</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="afa5ec65b6b6ea4a6a25e2a44ed13ad29"></a><!-- doxytag: member="swiril_main_qmi.c::deviceKeyOld" ref="afa5ec65b6b6ea4a6a25e2a44ed13ad29" args="[NUM_MAX_STR_LEN]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="swiqmi_2qa_2SwiDataTypes_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> <a class="el" href="swiril__main__qmi_8c.html#afa5ec65b6b6ea4a6a25e2a44ed13ad29">deviceKeyOld</a>[NUM_MAX_STR_LEN]<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a276138a9dc4e151b70badf6b74d47b69"></a><!-- doxytag: member="swiril_main_qmi.c::deviceNodeOld" ref="a276138a9dc4e151b70badf6b74d47b69" args="[NUM_MAX_STR_LEN]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="swiqmi_2qa_2SwiDataTypes_8h.html#aebb9e13210d88d43e32e735ada43a425">CHAR</a> <a class="el" href="swiril__main__qmi_8c.html#a276138a9dc4e151b70badf6b74d47b69">deviceNodeOld</a>[NUM_MAX_STR_LEN]<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="af68ac31b21f881f975bfa48bf4b060cb"></a><!-- doxytag: member="swiril_main_qmi.c::sierra_radio_notification" ref="af68ac31b21f881f975bfa48bf4b060cb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="swiril__main__qmi_8c.html#af68ac31b21f881f975bfa48bf4b060cb">sierra_radio_notification</a> = false<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
</div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Fri Aug 9 18:19:56 2013 for Sierra RIL by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
